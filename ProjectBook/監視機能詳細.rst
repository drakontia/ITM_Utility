4.1.1.2. Netcoolサーバー間疎通障害検知
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

(1) 処理概要
Netcoolサーバー監視は、Netcoolサーバーから統合監視システムに対して定期的にハートビートイベントを送信することによって実施する。
15分以上新規ハートビートイベントの通知がない場合、統合監視システムがお客様Netcoolサーバーに障害が発生したと判断し障害イベントを発砲する。

(2) 処理方式
Netcoolサーバー監視の処理方式を以下に示し、処理イメージを 図4-1-1-2_Netcoolサーバー間疎通障害検知方法 に示す。

①,Netcoolサーバーから統合監視システムに対して定期的にハートビートイベントを送信する
②,15分以上新規ハートビートイベントの通知がない場合、統合監視システムがお客様Netcoolサーバーに障害が発生したと判断し障害イベントを発砲する。

①ハートビートイベント通知

4.1.2. 監視抑止機能設計
--------------------------

諸事由により、発生した障害イベントが通知されるのを抑制する機能。
非監視の設定を行う場合、状況に応じて以下の手段を使い分けるものとする。

* 長期的に監視を抑止したい場合
    監視対象から除外するなど、長期的または恒久的に監視を抑止する必要がある場合、お客様環境のNetcoolサーバーにて監視抑止設定を実施する。（[A]）

* 一時的に監視を抑止したい場合
    サーバーの計画的再起動など、一時的に監視を抑止する必要がある場合、統合監視システム監視担当へ監視抑止を依頼する。（[B]）

4.1.3. ハートビート検知機能設計
----------------------------------

(1)  処理概要
JP1のハートビート監視は、JP1サーバーからお客様Netcoolサーバーに対して定期的にハートビートイベントを送信することによって実施する。

4.1.4. イベントリモート通知機能
----------------------------------

発生した障害イベントに対して、重大度に応じたフィルターに基づいて、メール、パトランプ、ポップアップなどを用いて通知する機能。

4.2. 監視機能設計
===================

4.2.1. 死活監視設計
----------------------

(1) 処理概要
Ping監視は、ITMからサーバー機器に対して定期的にネットワークインターフェースの状態を監視し、応答が無い場合に異常と判断する。
異常を検知した場合は、Object Serverに障害イベントの通知を行う。
Object Serverは、受信した障害イベントをDB(alerts.status)に格納し、かつ統合Netcoolサーバーへ転送する。
(2)  処理方式
Ping監視の処理方式を以下に示し、処理イメージを 図4-2-1_ping監視処理方式 に示す。
①,Netcoolサーバー上のITNMから、稼動監視対象機器に対してポーリング間隔でPingを行い、ネットワークインターフェースの状態を監視する。
②,稼動監視対象機器から応答が無い場合は、ノードダウンの障害としてObject Serverに障害イベントを転送する。
Object Serverへ通知するイベントを　表4-2 に示す。
③,統合Netcoolサーバーにイベントを転送する
Netcoolサーバー
表4-2_監視項目一覧

.. csv-table::
    :header-rows: 1

    項番,監視項目,内容
    1,ノードダウン,・管理対象のネットワークインターフェースとの通信が不可能となった状態。
    2,ノードアップ,・管理対象のネットワークインターフェースとの通信が回復した状態。

4.2.2. ハードウェア監視設計
------------------------------

4.2.2.1. errptによるハードウェア監視（AIX）
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

(1) 処理概要
Syslog Probeによるerrpt監視は、サーバー機器が出力するerrptのログを設定した固有のファイルに出力し監視を行う。
※errptログの直接監視を行わない理由は、Syslog Probeの仕様として複数行のログ監視を行うことが出来ないためである。
メッセージを検知した場合には異常と判断し、Object Serverに障害イベントの通知を行う。
Object Serverは、受信した障害イベントをDB(alerts.status)に格納し、かつ統合Netcoolサーバーへ転送する。
(2)  処理方式
errpt監視の処理方式を以下に示し、処理イメージを 図4-2-2-1_errpt監視処理方式 に示す。
①,サーバー機器はハードウェアに関する問題を検知した際に、errptへメッセージ出力を行う。
②,errptに出力されたメッセージは、内製ツールにより障害検知用のログファイルに出力される。
③,Syslog Probeが、対象のファイルに対して監視を行う。
④,新規メッセージをSyslog Probeが検知した場合、Object Serverにイベントを通知する。
⑤,統合Netcoolサーバーにイベントを転送する
Netcoolサーバー
AIXサーバー

4.2.2.2. SNMPトラップによるハードウェア監視（NW）
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

(1) 処理概要
SNMP Trap監視では、各ハードウェアからSNMP TrapをSNMP Trapd Probeに送信する。
SNMP Trapd Probeは、Object Serverに障害イベントの通知を行う。
Object Serverは、受信した障害イベントをObject Server内のDB(alerts.status)に格納し、かつ統合Netcool Serverへ転送する。
(2) 処理方式
SNMP Trap監視の処理方式を以下に示し、処理イメージを 図4-2-2-2_SNMP Trap監視処理方式 に示す。
①,各ハードウェアで障害が発生した場合、SNMP TrapをSNMP Trapd Probeに送信する。
②,SNMP Trapd Probeは、Object Serverに障害イベントを通知する。
③,統合Netcoolサーバーにイベントを転送する
※Probe Peer機能にて、Slave側をホットスタンバイ状態に設定
Netcoolサーバー

4.2.3. OS標準監視設計
------------------------

4.2.3.1. CPU監視
^^^^^^^^^^^^^^^^^^^^

(1) 処理概要
CPU監視では、スクリプトをcronにて定期的に起動し、CPUの使用率が指定された閾値を超過していないか監視する。
指定された閾値を超過している場合は、CPU監視スクリプトからEIF ProbeにEIFイベントを送信する。
EIF Probeは、イベント形式をNetcoolにて使用されているイベントに変換しObject Serverに障害イベントの通知を行う。
Object Serverは、受信した障害イベントをObject Server内のDB(alerts.status)に格納し、かつ統合Netcool Serverへ転送する。
(2) 処理方式
CPU監視の処理方式を以下に示し、処理イメージを 図4-2-3-1_CPU監視処理方式 に示す。
①,cronからCPU監視スクリプトを定期的に起動する。
②,スクリプトはCPUの使用率が指定された閾値を超過していないことを確認する。
③,指定された閾値を超過している場合、EIFイベントをEIF Probeに送信する。
④,EIF Probeは、イベント形式を変換しObject Serverに障害イベントを転送する。
⑤,統合Netcoolサーバーにイベントを転送する
Netcoolサーバー

4.2.3.2. メモリ監視
^^^^^^^^^^^^^^^^^^^^^^^

(1) 処理概要
メモリ監視では、スクリプトをcronにて定期的に起動し、メモリの使用率が指定された閾値を超過していないか監視する。
指定された閾値を超過している場合は、メモリ監視スクリプトからEIF ProbeにEIFイベントを送信する。
EIF Probeは、イベント形式をNetcoolにて使用されているイベントに変換しObject Serverに障害イベントの通知を行う。
Object Serverは、受信した障害イベントをObject Server内のDB(alerts.status)に格納し、かつ統合Netcool Serverへ転送する。
(2) 処理方式
メモリ監視の処理方式を以下に示し、処理イメージを 図4-2-3-2_メモリ監視処理方式に示す。
①,cronからメモリ監視スクリプトを定期的に起動する。
②,スクリプトはメモリの使用率が指定された閾値を超過していないことを確認する。
③,指定された閾値を超過している場合、EIFイベントをEIF Probeに送信する。
④,EIF Probeは、イベント形式を変換しObject Serverに障害イベントを転送する。
⑤,統合Netcoolサーバーにイベントを転送する
Netcoolサーバー

4.2.3.3. ファイルシステム監視
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

(1) 処理概要
ファイルシステム監視では、スクリプトをcronにて定期的に起動し、ファイルシステムの使用率が指定された閾値を超過していないか監視する。
指定された閾値を超過している場合は、ファイルシステム監視スクリプトからEIF ProbeにEIFイベントを送信する。
EIF Probeは、イベント形式をNetcoolにて使用されているイベントに変換しObject Serverに障害イベントの通知を行う。
Object Serverは、受信した障害イベントをObject Server内のDB(alerts.status)に格納し、かつ統合Netcool Serverへ転送する。
(2) 処理方式
ファイルシステム監視の処理方式を以下に示し、処理イメージを 図4-2-3-3_ファイルシステム監視処理方式 に示す。
①,cronからファイルシステム監視スクリプトを定期的に起動する。
②,スクリプトはファイルシステムの使用率が指定された閾値を超過していないことを確認する。
③,指定された閾値を超過している場合、EIFイベントをEIF Probeに送信する。
④,EIF Probeは、イベント形式を変換しObject Serverに障害イベントを転送する。
⑤,統合Netcoolサーバーにイベントを転送する
Netcoolサーバー

4.2.4. ミドルウェア/アプリケーション監視設計
------------------------------------------------

4.2.4.1. ファイルシステム監視
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

4.2.3.3章と同様の仕組みで実装する。

4.2.4.2. プロセス監視
^^^^^^^^^^^^^^^^^^^^^^^^^

(1) 処理概要
Probe監視は、各ProbeからObject Serverに対して定期的にハートビートイベントを送信することによって実施する。
一定時間ハートビートイベントが確認できない場合、Object Serverが障害イベントと判断する。
Object Serverは、受信した障害イベントをDB(alerts.status)に格納し、かつ統合Netcoolサーバーへ転送する。
(2) 処理方式
Probe監視の処理方式を以下に示し、処理イメージを 図4-2-4-2_Probe監視処理 に示す。
①,各Probeから、Object Serverに対して一定間隔でハートビートイベントの送信を行う。
②,一定時間以上ハートビートイベントの通知が無い場合は、Probeの障害としてObject Serverが障害イベントと判断する。
③,統合Netcoolサーバーにイベントを転送する
Netcoolサーバー

4.3. その他機能設計
---------------------

特になし

